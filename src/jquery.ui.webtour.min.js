(function(b){var a={firstPage:"ui-webtour-first",lastPage:"ui-webtour-last",page:"ui-webtour",prevButton:"ui-webtour-previous",nextButton:"ui-webtour-next",endButton:"ui-webtour-end",active:"ui-webtour-active",buttonSet:"ui-webtour-buttonset",button:"ui-webtour-button",arrowImage:"ui-webtour-arrow",primaryAction:"ui-webtour-PrimaryAction",secondaryAction:"ui-webtour-SecondaryAction"};b.widget("ui.webtour",{options:{autoStart:true,prevButton:"Previous",nextButton:"Next",stopButton:"End Tour",arrowImage:"<div />",dialogOptions:{autoOpen:false,resizable:false,draggable:true,buttons:{},close:function(){b(".ui-webtour-arrow").css({left:"0",top:"0"}).hide();var a=b(this).data("ui-webtour-instance");if(a)a._isOpen=false}},pageOptions:{defaults:{position:{my:"center center",at:"center center",of:window},arrow:null,arrowPosition:null,showPrevious:true,showNext:true,showEnd:true,title:"jQuery Web Tour",dialogOptions:{}}}},_create:function(){var c=this,d=c.options,e=c.element;this.pages=b([]);e.children().first().addClass(a.firstPage).end().last().addClass(a.lastPage).end().each(function(){var e=b(this),f=c._getPageData(e),i=e.attr("title"),h=b.extend({},d.dialogOptions),g=[];f.title&&b.extend(h,{title:f.title});i&&b.extend(h,{title:i});if(f.showPrevious&&!e.hasClass(a.firstPage))g[g.length]={text:d.prevButton,click:function(){!e.hasClass(a.firstPage)&&c.show(c.pages.eq(c.pages.index(e)-1))}};if(f.showNext&&!e.hasClass(a.lastPage))g[g.length]={text:d.nextButton,click:function(){!e.hasClass(a.lastPage)&&c.show(c.pages.eq(c.pages.index(e)+1))}};if(f.showEnd)g[g.length]={text:d.stopButton,click:function(){c.hide(e);c.pages.removeClass(a.active);c._trigger("end")}};g.length>0&&b.extend(h,{buttons:g});e.dialog(b.extend({},h,f.dialogOptions)).dialog("widget").find(".ui-dialog-buttonset").addClass(a.buttonSet).find(".ui-button").addClass(a.button).not(":contains("+d.stopButton+")").addClass(a.primaryAction);e.dialog("widget").find(".ui-button:contains("+d.stopButton+")").addClass(a.secondaryAction);f.arrow&&f.arrowPosition&&b(d.arrowImage).appendTo("body").addClass(f.arrow).addClass(a.arrowImage).addClass(a.arrowImage+"-"+c.pages.length).hide();c.pages=c.pages.add(e.addClass(a.page))});c._isOpen=false},_init:function(){this.options.autoStart&&this.show()},destroy:function(){},_getActivePage:function(d){var b=d||this.pages.filter("."+a.active).first(),c=this.getUI(null);if(!b.length)if(this._trigger("loadActivePage",null,c))b=c.savedPage||this.pages.filter("."+a.firstPage).first();return b},_getPageData:function(a){return b.extend({},this.options.pageOptions.defaults,this.options.pageOptions[a[0].id])},hide:function(c){var a=this._getActivePage(c),b=this.getUI(a,this.pages.index(a));if(false===this._trigger("beforeHide",null,b))return false;a&&a.dialog("close");this._isOpen=false;this._trigger("hide",null,b)},isOpen:function(){return this._isOpen},show:function(h){var c=this._getActivePage(h),d=this._getPageData(c),f=this.getUI(c,this.pages.index(c)),g=d.arrowPosition,e;if(false===this._trigger("beforeShow",null,f))return;if(this._isOpen&&this.hide()===false)return;e=c.data("ui-webtour-instance",this).dialog("open").dialog("widget").position(d.position);if(d.arrow&&d.arrowPosition){if(d.arrowPosition.of==="dialog")g.of=e;b("."+a.arrowImage+"-"+this.pages.index(c)).show().position(g).css({zIndex:parseInt(e.css("zIndex"))+10})}this.pages.removeClass(a.active);c.addClass(a.active);this._isOpen=true;this._trigger("saveActivePage",null,f);this._trigger("show",null,f)},_setOption:function(){b.Widget.prototype._setOption.apply(this,arguments)},getUI:function(a){a=typeof a==="string"?b(a):a;return{page:a,index:a?this.pages.index(a):null}}});b.extend(b.ui.webtour,{version:"1.0.0"})})(jQuery)